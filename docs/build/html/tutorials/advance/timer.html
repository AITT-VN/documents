

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>3. Timer &mdash; OhStem Product Documents 0.0.2 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4. Radio Broadcast" href="radio.html" />
    <link rel="prev" title="2. Storage" href="filesystem.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo-ohstem.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../board/index.html">xController Board</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">xController Micropython Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../basics/index.html">Basic Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Advance Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="random.html">1. Random Number</a></li>
<li class="toctree-l2"><a class="reference internal" href="filesystem.html">2. Storage</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3. Timer</a></li>
<li class="toctree-l2"><a class="reference internal" href="radio.html">4. Radio Broadcast</a></li>
<li class="toctree-l2"><a class="reference internal" href="i2c.html">5. I2C</a></li>
<li class="toctree-l2"><a class="reference internal" href="thread.html">6. Thread</a></li>
<li class="toctree-l2"><a class="reference internal" href="bme280.html">7. BME280</a></li>
<li class="toctree-l2"><a class="reference internal" href="iot/index.html">8. Internet of Things</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">xController Arduino Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../basics/index.html">Basic Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Advance Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="random.html">1. Random Number</a></li>
<li class="toctree-l2"><a class="reference internal" href="filesystem.html">2. Storage</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3. Timer</a></li>
<li class="toctree-l2"><a class="reference internal" href="radio.html">4. Radio Broadcast</a></li>
<li class="toctree-l2"><a class="reference internal" href="i2c.html">5. I2C</a></li>
<li class="toctree-l2"><a class="reference internal" href="thread.html">6. Thread</a></li>
<li class="toctree-l2"><a class="reference internal" href="bme280.html">7. BME280</a></li>
<li class="toctree-l2"><a class="reference internal" href="iot/index.html">8. Internet of Things</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">xController Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../library/micropython-api/index.html">MicroPython Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../library/arduino-api/index.html">Arduino Library</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">OhStem Product Documents</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Advance Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">3. </span>Timer</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/username/reponame/blob/mastertutorials/advance/timer.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="timer">
<h1><span class="section-number">3. </span>Timer<a class="headerlink" href="#timer" title="Permalink to this headline">¶</a></h1>
<p>The earliest timing tools used by humans were sand or water hourglasses, but later with watches and clocks, people began to try to use these new timing tool to improve the time accuracy and control. Timers makes time control much easier for many tasks that peoples’ require. Such as timers used in many home appliances use timers to control switches or operating duration.</p>
<hr class="docutils" />
<p>First, import the mpython、Timer、music modules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpython</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">machine</span> <span class="kn">import</span> <span class="n">Timer</span>
<span class="kn">import</span> <span class="nn">music</span>
</pre></div>
</div>
<p>Define timer callback function, play alarm sound:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">playMusic</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
    <span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">music</span><span class="o">.</span><span class="n">BA_DING</span><span class="p">,</span><span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Configure the timer, the mode is cyclic execution, the cyclic period is 5 seconds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tim1</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">Timer</span><span class="o">.</span><span class="n">PERIODIC</span><span class="p">,</span><span class="n">callback</span><span class="o">=</span><span class="n">playMusic</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">Timer.init(period=5000,</span> <span class="pre">mode=Timer.PERIODIC,callback=None)</span></code> to initialize the timer, <cite>mode</cite> can be one of the following：<cite>Timer.ONE_SHOT</cite> means that the timer runs once, until the time limit of the configured channel expires；<cite>Timer.PERIODIC</cite> means that the timer runs regularly at the channel ’s configured frequency.</p>
</div>
<p>Get and return the current count value of the timer, and then display it on the OLED display:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">timerNum</span><span class="o">=</span><span class="n">tim1</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="n">oled</span><span class="o">.</span><span class="n">DispChar</span><span class="p">(</span><span class="s2">&quot;Timer：</span><span class="si">%d</span><span class="s2"> ms&quot;</span> <span class="o">%</span><span class="n">timerNum</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span>
<span class="n">oled</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>timer.value() function is to get and return the current count value.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>您可能会看到定时器没到5000ms整警报声就响了，这是因为定时数据传送到OLED显示屏上这个过程中有延时。</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="radio.html" class="btn btn-neutral float-right" title="4. Radio Broadcast" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="filesystem.html" class="btn btn-neutral float-left" title="2. Storage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, OHSTEM.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>