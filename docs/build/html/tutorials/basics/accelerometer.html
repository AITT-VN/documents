

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>9. Accelerometer &mdash; OhStem Product Documents 0.0.2 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="10. Network" href="network/index.html" />
    <link rel="prev" title="8. Light Sensor" href="light.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo-ohstem.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../board/index.html">xController Board</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">xController Micropython Tutorial</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Basic Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="repl.html">1. REPL</a></li>
<li class="toctree-l2"><a class="reference internal" href="oled.html">2. Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="neopixel.html">3. RGB LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="buzz.html">4. Music</a></li>
<li class="toctree-l2"><a class="reference internal" href="buttons.html">5. Key Button</a></li>
<li class="toctree-l2"><a class="reference internal" href="touchpad.html">6. Touchpad</a></li>
<li class="toctree-l2"><a class="reference internal" href="sound.html">7. Microphone</a></li>
<li class="toctree-l2"><a class="reference internal" href="light.html">8. Light Sensor</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">9. Accelerometer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#horizontal-ball">9.1. Horizontal ball</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculate-the-tilt-angle-of-the-mpython-board">9.2. Calculate the tilt angle of the mPython Board</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="network/index.html">10. Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="uart.html">11. Serial Port</a></li>
<li class="toctree-l2"><a class="reference internal" href="io/index.html">12. Pins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advance/index.html">Advance Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">xController Arduino Tutorial</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Basic Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="repl.html">1. REPL</a></li>
<li class="toctree-l2"><a class="reference internal" href="oled.html">2. Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="neopixel.html">3. RGB LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="buzz.html">4. Music</a></li>
<li class="toctree-l2"><a class="reference internal" href="buttons.html">5. Key Button</a></li>
<li class="toctree-l2"><a class="reference internal" href="touchpad.html">6. Touchpad</a></li>
<li class="toctree-l2"><a class="reference internal" href="sound.html">7. Microphone</a></li>
<li class="toctree-l2"><a class="reference internal" href="light.html">8. Light Sensor</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">9. Accelerometer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#horizontal-ball">9.1. Horizontal ball</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculate-the-tilt-angle-of-the-mpython-board">9.2. Calculate the tilt angle of the mPython Board</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="network/index.html">10. Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="uart.html">11. Serial Port</a></li>
<li class="toctree-l2"><a class="reference internal" href="io/index.html">12. Pins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advance/index.html">Advance Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">xController Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../library/micropython-api/index.html">MicroPython Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../library/arduino-api/index.html">Arduino Library</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">OhStem Product Documents</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Basic Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">9. </span>Accelerometer</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/username/reponame/blob/mastertutorials/basics/accelerometer.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="accelerometer">
<h1><span class="section-number">9. </span>Accelerometer<a class="headerlink" href="#accelerometer" title="Permalink to this headline">¶</a></h1>
<p>The acceleration sensor can measure the acceleration due to gravity. During the acceleration process, the sensor uses the Newton’s second law to obtain the acceleration value by measuring the inertial force received by the mass. The accelerometer on the mPython Board can measure acceleration, with a measurement range of -2g to + 2g.。</p>
<p>It is 3-axis measurement of the mPython Board with positive or negative values on each axis. As the positive axis approaches the direction of gravitational acceleration, its value increases toward the positive direction, and conversely decreases toward the negative direction.</p>
<ul class="simple">
<li><p>X - Tilt forward and backward.</p></li>
<li><p>Y - Tilt left and right。</p></li>
<li><p>Z - Flip up and down。</p></li>
</ul>
<img alt="../images/tutorials/xyz.png" class="align-center" src="../images/tutorials/xyz.png" />
<p>Example：Observe the changes of the acceleration values of the three axes through the OLED display</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpython</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">oled</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">accelerometer</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">accelerometer</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span>
    <span class="n">z1</span> <span class="o">=</span> <span class="n">accelerometer</span><span class="o">.</span><span class="n">get_z</span><span class="p">()</span>
    <span class="n">oled</span><span class="o">.</span><span class="n">DispChar</span><span class="p">(</span><span class="s2">&quot;Acceleration x:&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">oled</span><span class="o">.</span><span class="n">DispChar</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">oled</span><span class="o">.</span><span class="n">DispChar</span><span class="p">(</span><span class="s2">&quot;Acceleration y:&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="n">oled</span><span class="o">.</span><span class="n">DispChar</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">y1</span><span class="p">),</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="n">oled</span><span class="o">.</span><span class="n">DispChar</span><span class="p">(</span><span class="s2">&quot;Acceleration z:&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">oled</span><span class="o">.</span><span class="n">DispChar</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">z1</span><span class="p">),</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">oled</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>First, import the mPython module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpython</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>Obtain X、Y、Z 3-axis acceleration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">accelerometer</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">accelerometer</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span>
<span class="n">z1</span> <span class="o">=</span> <span class="n">accelerometer</span><span class="o">.</span><span class="n">get_z</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Obtain the 3 axis acceleration by  accelerometer.get_x() . The methods to get the 3-axis acceleration are <code class="docutils literal notranslate"><span class="pre">get_x()</span></code> 、<code class="docutils literal notranslate"><span class="pre">get_y()</span></code> 、<code class="docutils literal notranslate"><span class="pre">get_z()</span></code> 。
The measured value of each axis is positive or negative according to the direction, indicating the value in grams。</p>
</div>
<p>You can try to place the mPython Board panel as follows and observe the 3-axis data:</p>
<ul class="simple">
<li><p>Flat on the surface top       –(0,0,-1)</p></li>
<li><p>Flip the flat surface top   –(0,0,1)</p></li>
<li><p>The bottom edge of the control board is upright –(1,0,0)</p></li>
<li><p>The left side of the control panel is upright –(0,1,0)</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Did you find any patterns? When the acceleration of gravity is consistent with the direction of the acceleration axis, it is equal to the acceleration of gravity of 1g. Positive direction is + 1g, negative direction is -1g.
If you shake the control panel violently, you will see the acceleration reach ± 2g, which is because the maximum measurement value of this accelerometer is ± 2g.</p>
</div>
<div class="section" id="horizontal-ball">
<h2><span class="section-number">9.1. </span>Horizontal ball<a class="headerlink" href="#horizontal-ball" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="../images/tutorials/gravity.gif"><img alt="../images/tutorials/gravity.gif" class="align-center" src="../images/tutorials/gravity.gif" /></a>
<p>When it is detected that the control panel is tilted in the X-axis and Y-axis directions (range -1g to + 1g), the X-axis and Y-axis offset values, that is, acceleration values (range -1 to 1), are mapped to set The center point is the Y coordinate (range 32 to -32) and the X coordinate (range -64 to 64) on the X coordinate of the origin:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">y</span><span class="o">&lt;=</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">y</span><span class="o">&gt;=-</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">offsetX</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">numberMap</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">))</span>
<span class="k">if</span> <span class="n">x</span><span class="o">&lt;=</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&gt;=-</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">offsetY</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">numberMap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="o">-</span><span class="mi">32</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>numberMap(inputNum, bMin, bMax, cMin, cMax) is the mapping function, <code class="docutils literal notranslate"><span class="pre">inputNum</span></code> is the variable to be mapped, <code class="docutils literal notranslate"><span class="pre">bMin</span></code> is the minimum value that needs to be mapped, <code class="docutils literal notranslate"><span class="pre">bMax</span></code> is the maximum value that needs to be mapped, <code class="docutils literal notranslate"><span class="pre">cMin</span></code> as the minimum value of the mapped, <code class="docutils literal notranslate"><span class="pre">cMax</span></code> as the maximum value of the mapped.</p>
</div>
<p>The movement of the horizontal ball on the X and Y coordinates: the movement of the horizontal ball on the coordinates = the position of the center point + the offset value of the acceleration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">move_x</span><span class="o">=</span><span class="n">Center_x</span><span class="o">+</span><span class="n">offsetX</span>
<span class="n">move_y</span><span class="o">=</span><span class="n">Center_y</span><span class="o">+</span><span class="n">offsetY</span>
</pre></div>
</div>
<p>If the horizontal ball moves to the center position, green light on, otherwise not lighted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">offsetX</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">offsetY</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">rgb</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>          <span class="c1">#The horizontal ball lights green at the center, with a brightness of 10</span>
    <span class="n">rgb</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">rgb</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>           <span class="c1">#The horizontal ball is not in the center position, and the green light not lighted</span>
    <span class="n">rgb</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-the-tilt-angle-of-the-mpython-board">
<h2><span class="section-number">9.2. </span>Calculate the tilt angle of the mPython Board<a class="headerlink" href="#calculate-the-tilt-angle-of-the-mpython-board" title="Permalink to this headline">¶</a></h2>
<p>First, import the mPython module and ACOS function and Degrees function in the math module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpython</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">acos</span><span class="p">,</span><span class="n">degrees</span>
</pre></div>
</div>
<p>Obtain the X axis acceleration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">accelerometer</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span>
</pre></div>
</div>
<p>Assuming that the reference plane of the mPython Board is the table top, during the tilting, the Y axis is parallel to the table top , and its angle is unchanged (always 0 degrees). What changes are the angle between the X axis and the desktop and the Z axis and the desktop. Angle, and the degree of change of the angle between the desktop and the X axis and Z axis is the same. In order to facilitate the analysis, we look down from the direction of the Y axis, then this problem will be simplified to only the two-dimensional relationship between the X axis and the Z axis. Suppose the control board is in the following state at a certain moment：</p>
<img alt="../images/tutorials/xgraph.png" class="align-center" src="../images/tutorials/xgraph.png" />
<p>In this figure, the Y axis has been simplified to coincide with the origin O of the coordinate system. Let’s take a look at how to calculate the tilt angle of the control panel, which is the angle a with the desktop. g is the acceleration of gravity, gx and gz are the components of g in the X axis and Z axis respectively.</p>
<div class="line-block">
<div class="line">Since the acceleration of gravity is perpendicular to the horizontal plane, we get：</div>
<div class="line">Angle a + angle b = 90 degrees</div>
<div class="line">The X-axis and Y-axis are perpendicular to each other.：</div>
<div class="line">Angle c + angle b = 90 degrees</div>
<div class="line">Therefore：</div>
<div class="line">angle a = angle c</div>
</div>
<p>According to the arc cosine theorem, calculate the radian value of angle b:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rad_x</span><span class="o">=</span><span class="n">acos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the angle of the included angle, ie angle a = angle c = 90 degrees-angle b:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">deg_x</span><span class="o">=</span><span class="mi">90</span><span class="o">-</span><span class="n">degrees</span><span class="p">(</span><span class="n">rad_x</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>acos() the function returns the arc cosine radian value.</p></li>
<li><p>degrees() the function is to convert radians to degrees.</p></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="network/index.html" class="btn btn-neutral float-right" title="10. Network" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="light.html" class="btn btn-neutral float-left" title="8. Light Sensor" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, OHSTEM.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>