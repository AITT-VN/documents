

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>8.2.2. Yeelight &mdash; OhStem Product Documents 0.0.2 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="8.2.3. BIGIOT" href="bigiot.html" />
    <link rel="prev" title="8.2.1. MQTT" href="mqtt.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html">
          

          
            
            <img src="../../../_static/logo-ohstem.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../board/index.html">xController Board</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">xController Micropython Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../basics/index.html">Basic Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Advance Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../random.html">1. Random Number</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystem.html">2. Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timer.html">3. Timer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../radio.html">4. Radio Broadcast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i2c.html">5. I2C</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thread.html">6. Thread</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bme280.html">7. BME280</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">8. Internet of Things</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#iot-basics">8.1. IoT basics</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#iot-tutorial">8.2. IoT tutorial</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="mqtt.html">8.2.1. MQTT</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">8.2.2. Yeelight</a></li>
<li class="toctree-l4"><a class="reference internal" href="bigiot.html">8.2.3. BIGIOT</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">xController Arduino Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../basics/index.html">Basic Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Advance Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../random.html">1. Random Number</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystem.html">2. Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timer.html">3. Timer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../radio.html">4. Radio Broadcast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i2c.html">5. I2C</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thread.html">6. Thread</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bme280.html">7. BME280</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">8. Internet of Things</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#iot-basics">8.1. IoT basics</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#iot-tutorial">8.2. IoT tutorial</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="mqtt.html">8.2.1. MQTT</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">8.2.2. Yeelight</a></li>
<li class="toctree-l4"><a class="reference internal" href="bigiot.html">8.2.3. BIGIOT</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">xController Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../library/micropython-api/index.html">MicroPython Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../library/arduino-api/index.html">Arduino Library</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">OhStem Product Documents</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Advance Tutorials</a> &raquo;</li>
        
          <li><a href="index.html"><span class="section-number">8. </span>Internet of Things</a> &raquo;</li>
        
      <li><span class="section-number">8.2.2. </span>Yeelight</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/username/reponame/blob/mastertutorials/advance/iot/yeelight.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="yeelight">
<h1><span class="section-number">8.2.2. </span>Yeelight<a class="headerlink" href="#yeelight" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://www.yeelight.com">Yeelight</a> has a complete smart home lighting product line, product series radiation home lighting series, desk lighting series, atmosphere lighting series and intelligent control series. It is Yeelight’s consistent pursuit to integrate cutting-edge technology and beautiful design.
AI technology, BLE MESH technology, and house full intelligent lighting technology are all widely used in its products. The entire line of WiFi products support intelligent voice control, lighting changes, etc.</p>
<div class="section" id="lan-control">
<h2><span class="section-number">8.2.2.1. </span>LAN control<a class="headerlink" href="#lan-control" title="Permalink to this headline">¶</a></h2>
<p>Yeelight supports Google Assistant and Amazon Alexa intelligent voice control. Also supports IFTTT. It can interact better with various network services such as social media and smart hardware. In the future, we will explain the relevant applications of IFTTT。
In addition, Yeelight is also launched for technology enthusiasts. A third-party control protocol can achieve personalized control within the LAN. This protocol is used to control the Yeelight intelligent lighting equipment by the control panel.</p>
<p>Yeelight third-party control protocol：<a class="reference external" href="https://www.yeelight.com/download/Yeelight_Inter-Operation_Spec.pdf">https://www.yeelight.com/download/Yeelight_Inter-Operation_Spec.pdf</a></p>
<div class="figure align-center" id="id2">
<a class="reference external image-reference" href="https://www.yeelight.com/zh_CN/developer"><img alt="../images/tutorials/yeelight/yeelight_lan.png" src="../images/tutorials/yeelight/yeelight_lan.png" /></a>
<p class="caption"><span class="caption-text">Yeelight LAN control</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="get-ready">
<h3><span class="section-number">8.2.2.1.1. </span>Get Ready<a class="headerlink" href="#get-ready" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>First of all, we must have a Yeelight intelligent lighting device. According to the official statement of Yeelight, all WiFi lighting devices on the market and subsequent WiFi products will support the LAN control protocol. I recommend the Yeelight LED light buld (color version), which is economical and can control the color.</p></li>
</ul>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../images/tutorials/yeelight/yeelight_led.png"><img alt="../images/tutorials/yeelight/yeelight_led.png" src="../images/tutorials/yeelight/yeelight_led.png" /></a>
<p class="caption"><span class="caption-text">Yeelight LED light bulb (color version)</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>Before using the YeeLight smart light bulb, you must use the YeeLight APP to configure the wifi connection and turn on the “LAN Control” function.</p></li>
</ul>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="../images/tutorials/yeelight/yeelight_app.gif"><img alt="../images/tutorials/yeelight/yeelight_app.gif" src="../images/tutorials/yeelight/yeelight_app.gif" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Yeelight configuration process</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>The mPython Board provides the  <code class="docutils literal notranslate"><span class="pre">yeelight</span></code> driver library, which can be obtained at  <a class="reference external" href="https://github.com/labplus-cn/awesome-mpython/tree/master/library/yeelight">awesome-mpython/libary/yeelight</a> . There is a more detailed API description of the  <code class="docutils literal notranslate"><span class="pre">yeelight</span></code> module.  <code class="docutils literal notranslate"><span class="pre">yeelight.py</span></code> downloaded to the file system of the mPython Board.</p></li>
<li><p>The mPython Board is connected to the same LAN as Yeelight。</p></li>
</ul>
</div>
<div class="section" id="programming">
<h3><span class="section-number">8.2.2.1.2. </span>Programming<a class="headerlink" href="#programming" title="Permalink to this headline">¶</a></h3>
<div class="section" id="discover-light-bulb">
<h4><span class="section-number">8.2.2.1.2.1. </span>Discover light bulb<a class="headerlink" href="#discover-light-bulb" title="Permalink to this headline">¶</a></h4>
<p>As the mPython Board and the Yeelight bulb are in the same LAN, we need to know the IP address of the bulb first, we can use the  <code class="docutils literal notranslate"><span class="pre">discover_bulbs()</span></code> function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpython</span> <span class="kn">import</span> <span class="o">*</span>                   <span class="c1"># import mpython module</span>
<span class="kn">from</span> <span class="nn">yeelight</span> <span class="kn">import</span> <span class="o">*</span>                  <span class="c1"># import yeelight module</span>

<span class="n">my_wifi</span> <span class="o">=</span> <span class="n">wifi</span><span class="p">()</span>                        <span class="c1"># Connect to the same LAN as YeeLight</span>
<span class="n">my_wifi</span><span class="o">.</span><span class="n">connectWiFi</span><span class="p">(</span><span class="s2">&quot;ssid&quot;</span><span class="p">,</span><span class="s2">&quot;password&quot;</span><span class="p">)</span>


<span class="n">discover_bulbs</span><span class="p">()</span>                        <span class="c1"># Discover device information of YeeLight in LAN</span>
</pre></div>
</div>
<p>The Yeelight bulb in the network responds and returns a dictionary containing the bulbs attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">discover_bulbs</span><span class="p">()</span>
<span class="go">[{&#39;ip&#39;: &#39;192.168.0.8&#39;, &#39;capabilities&#39;: {&#39;rgb&#39;: &#39;16711680&#39;, &#39;bright&#39;: &#39;100&#39;, &#39;support&#39;: &#39;get_prop set_default set_power toggle set_bright start_cf stop_cf set_scene cron_add cron_get cron_del set_ct_abx set_rgb set_hsv set_adjust adjust_bright adjust_ct adjust_color set_music set&#39;, &#39;sat&#39;: &#39;100&#39;, &#39;power&#39;: &#39;off&#39;, &#39;id&#39;: &#39;0x0000000007e7544d&#39;, &#39;name&#39;: &#39;&#39;, &#39;fw_ver&#39;: &#39;26&#39;, &#39;color_mode&#39;: &#39;2&#39;, &#39;hue&#39;: &#39;359&#39;, &#39;ct&#39;: &#39;3500&#39;, &#39;model&#39;: &#39;color&#39;}, &#39;port&#39;: &#39;55443&#39;}]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">discover_bulbs()</span></code> function to get the attributes of Yeelight devices in the network. From the above return, the IP address of the bulb is <code class="docutils literal notranslate"><span class="pre">192.168.0.8</span></code> .</p>
</div>
<div class="section" id="switch-control">
<h4><span class="section-number">8.2.2.1.2.2. </span>Switch Control<a class="headerlink" href="#switch-control" title="Permalink to this headline">¶</a></h4>
<p>Knowing the IP address, we construct the <code class="docutils literal notranslate"><span class="pre">Bulb</span></code>  object and control the light bulb switch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bulb</span><span class="o">=</span><span class="n">Bulb</span><span class="p">(</span><span class="s2">&quot;192.168.0.8&quot;</span><span class="p">)</span>    <span class="c1"># construct object</span>
<span class="n">bulb</span><span class="o">.</span><span class="n">turn_on</span><span class="p">()</span>              <span class="c1"># Turn ON instruction</span>
<span class="n">bulb</span><span class="o">.</span><span class="n">turn_off</span><span class="p">()</span>             <span class="c1"># Turn OFF instruction</span>
</pre></div>
</div>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">turn_on()</span></code> 、<code class="docutils literal notranslate"><span class="pre">turn_off()</span></code> can also use <code class="docutils literal notranslate"><span class="pre">toggle()</span></code> to reverse the state.</p>
</div>
<div class="section" id="brightness-adjustment">
<h4><span class="section-number">8.2.2.1.2.3. </span>Brightness Adjustment<a class="headerlink" href="#brightness-adjustment" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bulb</span><span class="o">.</span><span class="n">set_brightness</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">set_brightness(brightness)</span></code> , <code class="docutils literal notranslate"><span class="pre">brightness</span></code> parameter of brightness value, range of 0~100 .</p>
</div>
<div class="section" id="set-the-color">
<h4><span class="section-number">8.2.2.1.2.4. </span>Set the color<a class="headerlink" href="#set-the-color" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bulb</span><span class="o">.</span><span class="n">set_rgb</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>           <span class="c1"># Set bulb color via RGB</span>
<span class="n">bulb</span><span class="o">.</span><span class="n">set_hsv</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>           <span class="c1"># Set bulb color via HSV</span>
<span class="n">bulb</span><span class="o">.</span><span class="n">set_color_temp</span><span class="p">(</span><span class="mi">1700</span><span class="p">)</span>       <span class="c1"># Set the bulb color temperature</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">yeelight</span></code> module provides two functions, <code class="docutils literal notranslate"><span class="pre">set_rgb(red,</span> <span class="pre">green,</span> <span class="pre">blue)</span></code> and  <code class="docutils literal notranslate"><span class="pre">set_hsv(hue,</span> <span class="pre">saturation)</span></code> . “RGB” and “HSV” 2  color models to set the lamp light color. The RGB color model is more commonly used, I believe everyone is no stranger. Various colors can be obtained by changing the three color channels of red(R), green(G), and blue(B) and superimposing them.
HSV（Hue Saturation Value）：<code class="docutils literal notranslate"><span class="pre">hue</span></code> measured in degrees, with a value range of 0 to 359, calculated counterclockwise from red, red is 0°, green is 120°, blue is 240°. <code class="docutils literal notranslate"><span class="pre">saturation</span></code> means the degree to which the color is close to the spectral color. The higher the saturation of the color. High saturation, deep and gorgeous colors. Range of 0~100.
Value brightness parameter, no support is provided. Just set the <code class="docutils literal notranslate"><span class="pre">hue</span></code> 、<code class="docutils literal notranslate"><span class="pre">saturation</span></code> parameters. When doing some rainbow effects and color transitions, HSV is more natural.</p>
<p>You can also use the  <code class="docutils literal notranslate"><span class="pre">set_color_temp(degrees)</span></code> function to set the bulb color temperature,  <code class="docutils literal notranslate"><span class="pre">degrees</span></code> color temperature parameter, range 1700~6500。</p>
<div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="../images/tutorials/yeelight/hsv.png"><img alt="../images/tutorials/yeelight/hsv.png" src="../images/tutorials/yeelight/hsv.png" /></a>
<p class="caption"><span class="caption-text">Yeelight HSV color model</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<hr class="docutils" />
<div class="figure align-center" id="id6">
<a class="reference internal image-reference" href="../images/tutorials/yeelight/yeelight_show.gif"><img alt="../images/tutorials/yeelight/yeelight_show.gif" src="../images/tutorials/yeelight/yeelight_show.gif" /></a>
<p class="caption"><span class="caption-text">mPython Board controled Yeelight</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Yeelight, currently WiFi smart devices support up to 4 simultaneous TCP connections. Connection attempt will be rejected. For each connection, there is a command message quota limit,
That is 60 instructions per minute. All LANs also have a total quota limit of 144.</p>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="bigiot.html" class="btn btn-neutral float-right" title="8.2.3. BIGIOT" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="mqtt.html" class="btn btn-neutral float-left" title="8.2.1. MQTT" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, OHSTEM.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>