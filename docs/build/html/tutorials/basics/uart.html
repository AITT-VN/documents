

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>11. Serial Port &mdash; OhStem Product Documents 0.0.2 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="12. Pins" href="io/index.html" />
    <link rel="prev" title="10.6. Parsing JSON" href="network/parsing_json.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo-ohstem.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../board/index.html">xController Board</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">xController Micropython Tutorial</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Basic Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="repl.html">1. REPL</a></li>
<li class="toctree-l2"><a class="reference internal" href="oled.html">2. Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="neopixel.html">3. RGB LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="buzz.html">4. Music</a></li>
<li class="toctree-l2"><a class="reference internal" href="buttons.html">5. Key Button</a></li>
<li class="toctree-l2"><a class="reference internal" href="touchpad.html">6. Touchpad</a></li>
<li class="toctree-l2"><a class="reference internal" href="sound.html">7. Microphone</a></li>
<li class="toctree-l2"><a class="reference internal" href="light.html">8. Light Sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="accelerometer.html">9. Accelerometer</a></li>
<li class="toctree-l2"><a class="reference internal" href="network/index.html">10. Network</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">11. Serial Port</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-concept-of-serial-port">11.1. Basic concept of serial port</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#serial-port-principle">11.1.1. Serial port principle</a></li>
<li class="toctree-l4"><a class="reference internal" href="#baud-rate">11.1.2. Baud rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tx-at-the-transmitter-and-rx-at-the-receiver">11.1.3. TX at the transmitter and RX at the receiver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#serial-port-operation">11.2. Serial port operation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#construct-uart">11.2.1. construct UART</a></li>
<li class="toctree-l4"><a class="reference internal" href="#serial-port-transmission">11.2.2. Serial port transmission</a></li>
<li class="toctree-l4"><a class="reference internal" href="#serial-port-reading">11.2.3. Serial port reading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#expansion">11.3. Expansion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="io/index.html">12. Pins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advance/index.html">Advance Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">xController Arduino Tutorial</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Basic Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="repl.html">1. REPL</a></li>
<li class="toctree-l2"><a class="reference internal" href="oled.html">2. Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="neopixel.html">3. RGB LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="buzz.html">4. Music</a></li>
<li class="toctree-l2"><a class="reference internal" href="buttons.html">5. Key Button</a></li>
<li class="toctree-l2"><a class="reference internal" href="touchpad.html">6. Touchpad</a></li>
<li class="toctree-l2"><a class="reference internal" href="sound.html">7. Microphone</a></li>
<li class="toctree-l2"><a class="reference internal" href="light.html">8. Light Sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="accelerometer.html">9. Accelerometer</a></li>
<li class="toctree-l2"><a class="reference internal" href="network/index.html">10. Network</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">11. Serial Port</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-concept-of-serial-port">11.1. Basic concept of serial port</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#serial-port-principle">11.1.1. Serial port principle</a></li>
<li class="toctree-l4"><a class="reference internal" href="#baud-rate">11.1.2. Baud rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tx-at-the-transmitter-and-rx-at-the-receiver">11.1.3. TX at the transmitter and RX at the receiver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#serial-port-operation">11.2. Serial port operation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#construct-uart">11.2.1. construct UART</a></li>
<li class="toctree-l4"><a class="reference internal" href="#serial-port-transmission">11.2.2. Serial port transmission</a></li>
<li class="toctree-l4"><a class="reference internal" href="#serial-port-reading">11.2.3. Serial port reading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#expansion">11.3. Expansion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="io/index.html">12. Pins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advance/index.html">Advance Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">xController Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../library/micropython-api/index.html">MicroPython Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../library/arduino-api/index.html">Arduino Library</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">OhStem Product Documents</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Basic Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">11. </span>Serial Port</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/username/reponame/blob/mastertutorials/basics/uart.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="serial-port">
<h1><span class="section-number">11. </span>Serial Port<a class="headerlink" href="#serial-port" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basic-concept-of-serial-port">
<h2><span class="section-number">11.1. </span>Basic concept of serial port<a class="headerlink" href="#basic-concept-of-serial-port" title="Permalink to this headline">¶</a></h2>
<div class="section" id="serial-port-principle">
<h3><span class="section-number">11.1.1. </span>Serial port principle<a class="headerlink" href="#serial-port-principle" title="Permalink to this headline">¶</a></h3>
<p>The English abbreviation for serial communication is UART, which stands for Universal Asynchronous Receiver Transmitter.
It is an advance concept, as shown in the figure below, two devices are connected in a line, and the sender’s online end converts the data into a binary sequence, using high and low levels to send 01 signals in sequence, and the receiver’s online another Read the high and low level signals on this signal line at one end, corresponding to the 01 sequence of binary conversion.
Asynchronous sending and receiving refers to full-duplex transmission, that is, sending data and receiving data at the same time. The two are synchronized. Just like our phones, we can hear each other’s voices while talking.</p>
<p>Whenever we want to communicate between a PC and an MCU or between two MCUs, the easiest way is to use UART. Only two wires are required to transfer data between two UARTs. Data flows from the Tx pin of the sending UART to the Rx pin of the receiving UART.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="../images/tutorials/serial-two-wire.png"><img alt="../images/tutorials/serial-two-wire.png" src="../images/tutorials/serial-two-wire.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Principle of serial communication</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="baud-rate">
<h3><span class="section-number">11.1.2. </span>Baud rate<a class="headerlink" href="#baud-rate" title="Permalink to this headline">¶</a></h3>
<p>Baud rate (baudrate) refers to the number of bits transmitted by our serial communication per second. In layman’s terms, it is how many binary numbers of 1 and 0 can be sent in one second. For example, a baud rate of 9600 means that 9600 secondary sequences consisting of 0 and 1 can be sent in 1S.</p>
</div>
<div class="section" id="tx-at-the-transmitter-and-rx-at-the-receiver">
<h3><span class="section-number">11.1.3. </span>TX at the transmitter and RX at the receiver<a class="headerlink" href="#tx-at-the-transmitter-and-rx-at-the-receiver" title="Permalink to this headline">¶</a></h3>
<p>UART communication basically uses 2 pins for data transmission. Tx-pin for sending of data, Rx-pin for receiving of data. For two serial ports to communicate, at least three wires are required to connect.</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../images/tutorials/uart_pin.png"><img alt="../images/tutorials/uart_pin.png" src="../images/tutorials/uart_pin.png" style="width: 250px;" /></a>
<p class="caption"><span class="caption-text">RX stands for information receiving end, TX stands for information sending end</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>If some modules are connected, the module does not have its own power supply, and it needs to connected to VCC！</p>
</div>
</div>
</div>
<div class="section" id="serial-port-operation">
<h2><span class="section-number">11.2. </span>Serial port operation<a class="headerlink" href="#serial-port-operation" title="Permalink to this headline">¶</a></h2>
<p>The following communicates with the serial port of the Blue:bit Bluetooth slave module through the mPython Board to finally realize the BT communication function of the mPython Board.</p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="http://wiki.labplus.cn/images/a/a2/黑色传感器最终版12.20-11.png"><img alt="http://wiki.labplus.cn/images/a/a2/黑色传感器最终版12.20-11.png" src="http://wiki.labplus.cn/images/a/a2/黑色传感器最终版12.20-11.png" style="width: 250px;" /></a>
<p class="caption"><span class="caption-text">blue:bit BT module</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="construct-uart">
<h3><span class="section-number">11.2.1. </span>construct UART<a class="headerlink" href="#construct-uart" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpython</span> <span class="kn">import</span> <span class="o">*</span>                            <span class="c1"># import all mPython object</span>

<span class="n">uart</span><span class="o">=</span><span class="n">UART</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">baudrate</span><span class="o">=</span><span class="mi">9600</span><span class="p">,</span><span class="n">tx</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">P15</span><span class="p">,</span><span class="n">rx</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">P16</span><span class="p">)</span> <span class="c1"># construct UART object，set Baud Rate at 9600，the TX、RX pins are P15、P16 respectively.</span>
</pre></div>
</div>
<p>HC06(blue:bit BT slave module) The default factory baud rate is 9600. Need to use the factory default setting baud rate of 9600. Then based on your needs of the connecting serial port to set the baud rate.</p>
<p><code class="docutils literal notranslate"><span class="pre">UART(id,</span> <span class="pre">baudrate,</span> <span class="pre">bits,</span> <span class="pre">parity,</span> <span class="pre">stop,</span> <span class="pre">tx,</span> <span class="pre">rx,</span> <span class="pre">rts,</span> <span class="pre">cts,</span> <span class="pre">timeout)</span></code> , <code class="docutils literal notranslate"><span class="pre">id</span></code> is the serial port number, which can be set as 1 ~ 2. The mPython Board had 3 groups of serial ports, which 0 had been allocated for REPL.
<code class="docutils literal notranslate"><span class="pre">baudrate</span></code> is parameter for Baud Rate, <code class="docutils literal notranslate"><span class="pre">tx</span></code> is the mapping pin on mPython Board for sending, <code class="docutils literal notranslate"><span class="pre">rx</span></code> is the mapping pin for receiving. All pins can be used as serial port input RX, except `` P2``, `` P3``, `` P4``, `` P10`` can only be used as input, theoretically all other pins can be used as output TX. Generally, only the above parameters need to be set, and other parameters will remain the default parameters. For more UART parameters, refers to  <span class="xref std std-ref">machine.UART</span> chapter.</p>
</div>
<div class="section" id="serial-port-transmission">
<h3><span class="section-number">11.2.2. </span>Serial port transmission<a class="headerlink" href="#serial-port-transmission" title="Permalink to this headline">¶</a></h3>
<p>Use a Bluetooth-enabled computer or mobile phone to download the Bluetooth debugging assistant for BT module pairing. As such to realize the transmission of the mPython Board to the computer/mobile phone.</p>
<p>After successful pairing, send byte data to the serial port:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">uart</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;hello,world!&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, use the serial port assistant to check if received the data from the mPython Board. The <code class="docutils literal notranslate"><span class="pre">uart.write(buf)</span></code> function writes (sends) byte data to the serial port and returns the length of the data.</p>
</div>
<div class="section" id="serial-port-reading">
<h3><span class="section-number">11.2.3. </span>Serial port reading<a class="headerlink" href="#serial-port-reading" title="Permalink to this headline">¶</a></h3>
<p>The mPython Board receives serial data and displays the data on the OLED screen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpython</span> <span class="kn">import</span> <span class="o">*</span>                               <span class="c1"># Import all mpython object</span>

<span class="n">uart</span><span class="o">=</span><span class="n">UART</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">baudrate</span><span class="o">=</span><span class="mi">9600</span><span class="p">,</span><span class="n">tx</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">P15</span><span class="p">,</span><span class="n">rx</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">P16</span><span class="p">,</span><span class="n">timeout</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>    <span class="c1"># Example UART, set baud rate 9600, TX, RX mapping pins are P15, P16, timeout is set to 200ms</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">if</span><span class="p">(</span><span class="n">uart</span><span class="o">.</span><span class="n">any</span><span class="p">()):</span>                     <span class="c1"># When the serial port has readable data</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">uart</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>          <span class="c1"># Read a line of data from the serial port</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;received:&quot;</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>         <span class="c1"># Print received data</span>
        <span class="n">oled</span><span class="o">.</span><span class="n">DispChar</span><span class="p">(</span><span class="s2">&quot;接收:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>     <span class="c1"># Display data on the OLED, pay attention to the need to decode the bytecode into a string</span>
        <span class="n">oled</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>                     <span class="c1"># take effect</span>
        <span class="n">oled</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                    <span class="c1"># clear screen</span>
</pre></div>
</div>
<p>Now, you can send data to the serial port through the serial assistant, when the control panel receives the serial data, print and display it to the OLED screen. In the while loop, polling uses <code class="docutils literal notranslate"><span class="pre">uart.any()</span></code> to determine whether there is readable data in the serial port. When there is data, use <code class="docutils literal notranslate"><span class="pre">uart.readline()</span></code> read a line of data. It should be noted that the serial port receives the byte type. If it is transmitted to the OLED display, you need to use  <code class="docutils literal notranslate"><span class="pre">decode()</span></code>  to convert the byte to a string.</p>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">UART.readline()</span></code> to read data, you can also use <code class="docutils literal notranslate"><span class="pre">UART.read(length)</span></code> to read data of specified length from the serial.</p>
</div>
</div>
<div class="section" id="expansion">
<h2><span class="section-number">11.3. </span>Expansion<a class="headerlink" href="#expansion" title="Permalink to this headline">¶</a></h2>
<p>After learning how to use the serial port, you can realize the communication between the control board and other MCU (Arduino), computer / mobile phone, electronic module. With more extensive application, imagine and use the serial port and with your imagination to build and create more interesting things！</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="io/index.html" class="btn btn-neutral float-right" title="12. Pins" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="network/parsing_json.html" class="btn btn-neutral float-left" title="10.6. Parsing JSON" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, OHSTEM.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>